<%= simple_form_for resource, url: reservations_path, method: 'POST' do |f| %>


  <div class="weui-cells__title">预约</div>

  <!-- <p class="weui-cells_tips">准备预约医生提交预约医生完善姓名、小孩性别、您的联系方式、您的位置、不适症状描述</p> -->

  <div class="weui-cells weui-cells_form">

    <div class="weui-cell">
      <div class="weui-cell__hd">
        <label class="weui_label" for="">怎么称呼您</label>
      </div>
      <div class="weui-cell__bd weui-cell_primary">
        <input class="weui_input" name="reservation[name]" data-parsley-required="true" placeholder="这里写王先生或郑女士就可以了" type="text" value="">
      </div>
    </div>

    <div class="weui-cell weui-cell_select weui_select_after">
      <div class="weui-cell__hd">
          <label for="" class="weui_label">男孩还是女孩</label>
      </div>
      <div class="weui-cell__bd weui-cell_primary">
          <select class="weui_select" name="reservation[child_gender]" data-parsley-required="true">
            <%= options_for_select Reservation::GENDERS, "儿子" %>
          </select>
      </div>
    </div>

    <div class="weui-cell">
      <div class="weui-cell__hd">
        <label class="weui_label" for="">您的电话</label>
      </div>
      <div class="weui-cell__bd weui-cell_primary">
        <input class="weui_input" name="reservation[mobile_phone]" placeholder="医生可以看到您的电话并联系你" type="number"
          data-parsley-required="true" data-parsley-pattern="/^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/" data-parsley-type="integer" data-parsley-length="[11,11]" value="">
      </div>
    </div>

    <div class="weui-cell">
      <div class="weui-cell__hd">
        <label class="weui_label" for="">您的位置</label>
      </div>
      <div class="weui-cell__bd weui-cell_primary">
        <input class="weui_input" name="reservation[location]" data-parsley-required="true" type="text" placeholder="方便为你就近预约" value="">
      </div>
    </div>

    <div class="weui-cell">
      <div class="weui-cell__hd">
        <label class="weui_label" for="">症状</label>
      </div>
      <div class="weui-cell__bd weui-cell_primary">
        <textarea class="weui_textarea" name="reservation[remark]" data-parsley-required="true" placeholder="请大概描述下你孩子的情况"></textarea>
      </div>
    </div>

  </div>

  <!-- <p class="weui-cells_tips">底部说明文字底部说明文字</p> -->

  <div class="weui-btn_area">
    <!-- <a class="weui-btn weui-btn__primary" href="javascript:">确定</a> -->
    <%= f.button :submit, "确定", class: "weui-btn weui-btn__primary", data: { disable_with: '正在提交...' } %>
  </div>

<% end %>


<%- content_for :js  do %>
<script type="text/javascript">
  $(function(){
    if(navigator.geolocation){
      navigator.geolocation.getCurrentPosition(onSuccess,onError);
    } else {
      console.log("Geolocation is not supported by this browser.");
    }

    function onSuccess(e){
      console.log('on geoLocation success, center and zoom current position')
      // var mk = new BMap.Marker(e.coords.longitude, e.coords.latitude);    //基于定位的这个点的点位创建marker
      // map.addOverlay(mk);    //将marker作为覆盖物添加到map地图上
      // map.panTo(e.coords);   //将地图中心点移动到定位的这个点位置。注意是r.point而不是r对象。
      // map.centerAndZoom(new BMap.Point(e.coords.longitude, e.coords.latitude), 12);
      console.log(e.coords.longitude, e.coords.latitude);

    }

    function onError(e){
      console.log('on geoLocation failed')
    }

    $('.simple_form.new_reservation').parsley({
      uiEnabled: true,
      errorsWrapper: ''
    }).on('field:error', function() {
      $(this.$element).parents('.weui-cell').addClass('validation_error')
    }).on('field:success', function() {
      $(this.$element).parents('.weui-cell').removeClass('validation_error')
    })
  })
</script>
<% end %>
